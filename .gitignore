@echo off
chcp 65001 >nul
setlocal enabledelayedexpansion

echo ================================
echo   GitHub Pages ìë™ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
echo   Windows í™˜ê²½ ìµœì í™” ë²„ì „
echo ================================

REM í˜„ì¬ ë””ë ‰í† ë¦¬ í™•ì¸
echo í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬: %CD%

REM Git ì„¤ì¹˜ í™•ì¸
echo.
echo [0/8] Git ì„¤ì¹˜ í™•ì¸...
git --version >nul 2>&1
if errorlevel 1 (
    echo ì˜¤ë¥˜: Gitì´ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
    echo Gitì„ ì„¤ì¹˜í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
    echo ë‹¤ìš´ë¡œë“œ: https://git-scm.com/download/win
    pause
    exit /b 1
)
echo Git ì„¤ì¹˜ í™•ì¸ ì™„ë£Œ!

REM ì´ë¯¸ Git ì €ì¥ì†Œì¸ì§€ í™•ì¸
echo.
echo [1/8] Git ì €ì¥ì†Œ í™•ì¸/ì´ˆê¸°í™”...
if not exist ".git\" (
    git init
    echo Git ì €ì¥ì†Œ ì´ˆê¸°í™” ì™„ë£Œ!
) else (
    echo ê¸°ì¡´ Git ì €ì¥ì†Œ ë°œê²¬!
)

REM .gitignore íŒŒì¼ ìƒì„± (ì—†ì„ ê²½ìš°)
if not exist ".gitignore" (
    echo.
    echo [ì¶”ê°€] .gitignore íŒŒì¼ ìƒì„±...
    (
    echo # Windows
    echo Thumbs.db
    echo ehthumbs.db
    echo Desktop.ini
    echo $RECYCLE.BIN/
    echo.
    echo # IDE
    echo .vscode/
    echo .idea/
    echo *.swp
    echo *.swo
    echo.
    echo # Dependencies
    echo node_modules/
    echo.
    echo # Build
    echo dist/
    echo build/
    echo.
    echo # Logs
    echo *.log
    echo logs/
    ) > .gitignore
    echo .gitignore íŒŒì¼ ìƒì„± ì™„ë£Œ!
)

REM íŒŒì¼ ìƒíƒœ í™•ì¸
echo.
echo [2/8] íŒŒì¼ ìƒíƒœ í™•ì¸...
git status --porcelain >nul 2>&1
if errorlevel 1 (
    echo ê²½ê³ : Git ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
)

REM ëª¨ë“  íŒŒì¼ì„ ìŠ¤í…Œì´ì§• ì˜ì—­ì— ì¶”ê°€
echo.
echo [3/8] íŒŒì¼ë“¤ì„ ìŠ¤í…Œì´ì§•...
git add .
if errorlevel 1 (
    echo ì˜¤ë¥˜: íŒŒì¼ ìŠ¤í…Œì´ì§•ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
    pause
    exit /b 1
)
echo íŒŒì¼ ìŠ¤í…Œì´ì§• ì™„ë£Œ!

REM ë³€ê²½ì‚¬í•­ì´ ìˆëŠ”ì§€ í™•ì¸
git diff --cached --quiet
if not errorlevel 1 (
    echo.
    echo ë³€ê²½ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ì»¤ë°‹ì„ ìƒì„±í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    echo ê¸°ì¡´ ì½”ë“œë¥¼ í‘¸ì‹œí•©ë‹ˆë‹¤...
    goto :push_code
)

REM ì»¤ë°‹ ë©”ì‹œì§€ ì…ë ¥
echo.
set /p "commit_msg=ì»¤ë°‹ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš” (Enter = ê¸°ë³¸ê°’ ì‚¬ìš©): "
if "!commit_msg!"=="" set "commit_msg=Deploy to GitHub Pages - %date% %time%"

echo.
echo [4/8] ì»¤ë°‹ ìƒì„±...
git commit -m "!commit_msg!"
if errorlevel 1 (
    echo ì˜¤ë¥˜: ì»¤ë°‹ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
    pause
    exit /b 1
)
echo ì»¤ë°‹ ìƒì„± ì™„ë£Œ!

:push_code
REM GitHub ì •ë³´ ì…ë ¥
echo.
echo ========== GitHub ì €ì¥ì†Œ ì •ë³´ ì…ë ¥ ==========
set /p "username=GitHub ì‚¬ìš©ìëª…: "
if "!username!"=="" (
    echo ì˜¤ë¥˜: GitHub ì‚¬ìš©ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.
    pause
    exit /b 1
)

set /p "repo_name=GitHub ì €ì¥ì†Œ ì´ë¦„: "
if "!repo_name!"=="" (
    echo ì˜¤ë¥˜: ì €ì¥ì†Œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.
    pause
    exit /b 1
)

REM ì›ê²© ì €ì¥ì†Œ í™•ì¸ ë° ì„¤ì •
echo.
echo [5/8] ì›ê²© ì €ì¥ì†Œ ì„¤ì •...
git remote get-url origin >nul 2>&1
if not errorlevel 1 (
    echo ê¸°ì¡´ ì›ê²© ì €ì¥ì†Œë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤...
    git remote set-url origin https://github.com/!username!/!repo_name!.git
) else (
    echo ìƒˆ ì›ê²© ì €ì¥ì†Œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤...
    git remote add origin https://github.com/!username!/!repo_name!.git
)
echo ì›ê²© ì €ì¥ì†Œ ì„¤ì • ì™„ë£Œ!

REM ë¸Œëœì¹˜ í™•ì¸ ë° ì„¤ì •
echo.
echo [6/8] ë¸Œëœì¹˜ ì„¤ì •...
for /f %%i in ('git branch --show-current') do set current_branch=%%i
if not "!current_branch!"=="main" (
    git branch -M main
    echo ë©”ì¸ ë¸Œëœì¹˜ë¡œ ë³€ê²½ ì™„ë£Œ!
) else (
    echo ì´ë¯¸ main ë¸Œëœì¹˜ì…ë‹ˆë‹¤.
)

REM GitHubì— í‘¸ì‹œ
echo.
echo [7/8] GitHubì— í‘¸ì‹œ ì¤‘...
echo ì¸ì¦ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤...
git push -u origin main
if errorlevel 1 (
    echo.
    echo ì˜¤ë¥˜: GitHub í‘¸ì‹œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
    echo.
    echo ê°€ëŠ¥í•œ ì›ì¸:
    echo 1. GitHub ì¸ì¦ ë¬¸ì œ (Personal Access Token í•„ìš”)
    echo 2. ì €ì¥ì†Œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
    echo 3. ê¶Œí•œ ë¶€ì¡±
    echo.
    echo GitHub Personal Access Token ì„¤ì •:
    echo https://github.com/settings/tokens
    pause
    exit /b 1
)
echo GitHub í‘¸ì‹œ ì™„ë£Œ!

REM GitHub Pages ìë™ í™œì„±í™” ì‹œë„ (gh CLI ì‚¬ìš©)
echo.
echo [8/8] GitHub Pages ì„¤ì • ì‹œë„...
gh --version >nul 2>&1
if not errorlevel 1 (
    echo GitHub CLIê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. Pages ìë™ ì„¤ì •ì„ ì‹œë„í•©ë‹ˆë‹¤...
    gh api repos/!username!/!repo_name!/pages -f source[branch]=main -f source[path]=/ >nul 2>&1
    if not errorlevel 1 (
        echo GitHub Pages ìë™ ì„¤ì • ì™„ë£Œ!
    ) else (
        echo GitHub Pages ìˆ˜ë™ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
    )
) else (
    echo GitHub CLIê°€ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ë™ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
)

echo.
echo ================================
echo        ë°°í¬ ì™„ë£Œ!
echo ================================
echo.
echo ğŸ‰ ì„±ê³µì ìœ¼ë¡œ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤!
echo.
echo ğŸ“ GitHub ì €ì¥ì†Œ: https://github.com/!username!/!repo_name!
echo ğŸŒ GitHub Pages URL: https://!username!.github.io/!repo_name!
echo.
echo âš ï¸  GitHub Pages ìˆ˜ë™ ì„¤ì •ì´ í•„ìš”í•œ ê²½ìš°:
echo    1. https://github.com/!username!/!repo_name!/settings/pages
echo    2. Source: "Deploy from a branch" ì„ íƒ
echo    3. Branch: "main" ì„ íƒ, Folder: "/ (root)" ì„ íƒ
echo    4. Save í´ë¦­
echo.
echo â° í˜ì´ì§€ í™œì„±í™”ê¹Œì§€ ìµœëŒ€ 10ë¶„ ì†Œìš”ë©ë‹ˆë‹¤.
echo.

REM ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸° ì˜µì…˜
set /p "open_browser=ğŸ”— GitHub ì €ì¥ì†Œë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¹Œìš”? (Y/N): "
if /i "!open_browser!"=="Y" (
    start https://github.com/!username!/!repo_name!/settings/pages
    echo ë¸Œë¼ìš°ì €ì—ì„œ GitHub Pages ì„¤ì • í˜ì´ì§€ë¥¼ ì—´ì—ˆìŠµë‹ˆë‹¤.
)

echo.
echo âœ… ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì™„ë£Œ!
echo ë¬¸ì œê°€ ë°œìƒí•˜ë©´ GitHub Desktop ë˜ëŠ” Git GUI ë„êµ¬ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
echo.
pause